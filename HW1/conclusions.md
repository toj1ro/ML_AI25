# Выводы по домашнему заданию №1

## Описание задачи

Задача: построить модель регрессии для предсказания стоимости автомобилей на основе их характеристик.

---

## Что было сделано

### 1. EDA и обработка данных

- Загружены тренировочные и тестовые данные
- Проанализированы пропуски в данных
- Пропуски заполнены медианными значениями
- Удалено 1799 дубликатов
- Преобразованы типы данных
- Удалён столбец torque

### 2. Визуализации

- Построена корреляционная матрица числовых признаков
- Созданы дополнительные визуализации:
  - Распределение цен по типу топлива и трансмиссии
  - Зависимость цены от года выпуска по типу продавца
  - Распределение пробега по категории владельца

### 3. Обучение моделей

Обучены следующие модели:

| Модель | R² Train | R² Test | Business Metric (Test) |
|--------|----------|---------|------------------------|
| LinearRegression | 0.5923 | 0.5941 | 22.70% |
| Lasso (default) | 0.5923 | 0.5941 | 22.50% |
| Lasso (GridSearchCV) | 0.5923 | 0.5936 | 22.50% |
| ElasticNet (GridSearchCV) | 0.5884 | 0.5722 | 24.10% |
| **Ridge (с категориальными признаками)** | **0.6642** | **0.6146** | **25.60%** |

### 4. Кодирование признаков

- Применено One-Hot кодирование для категориальных признаков: `fuel`, `seller_type`, `transmission`, `owner`, `seats`
- Использован параметр `drop='first'` для избежания мультиколлинеарности
- Числовые признаки стандартизированы с помощью StandardScaler

---

## Результаты

### Лучшая модель: Ridge Regression

- **R² на тесте:** 0.6146
- **MSE на тесте:** 2.22e+11
- **Business Metric:** 25.60% (доля предсказаний в пределах ±10% от реальной цены)

### Наиболее важные признаки (по абсолютному значению коэффициента):

1. **max_power** (мощность) — самый важный признак
2. **year** (год выпуска) — новые автомобили дороже
3. **engine** (объём двигателя)
4. **km_driven** (пробег) — отрицательная связь
5. **mileage** (расход топлива)

---

## Что дало наибольший прирост качества

1. **Добавление категориальных признаков** — увеличило R² с 0.59 до 0.61
2. **Использование Ridge регрессии** вместо обычной линейной регрессии
3. **Удаление дубликатов** — улучшило качество данных для обучения

---

## Что сделать не удалось

1. **Не удалось занулить коэффициенты через Lasso** — при оптимальном alpha все признаки остались значимыми
2. **Относительно низкая business metric (25.60%)** — только четверть предсказаний попадает в ±10% от реальной цены
3. **Не обработан столбец `name`** — он содержит слишком много уникальных значений, что затрудняет кодирование

### Причины:
- Высокая вариативность цен на автомобили
- Влияние неучтённых факторов (состояние авто, комплектация, регион)
- Ограниченное количество признаков после удаления `name` и `torque`

---

## Оценка разработанного Streamlit-сервиса

### Что получилось хорошо:

1**Гибкий ввод данных** поддержка как ручного ввода, так и загрузки CSV
3. **Много изуализации** корреляционная матрица, распределения, boxplot'ы
4. **Интерпретация модели** понятное объяснение весов и их влияния на цену

### Ограничения и проблемы:
1. Нет валидации диапазонов вводимых значений

### Планируемые улучшения:

1. Добавить валидацию входных данных
2. Реализовать кэширование предсказаний
3. Добавить сравнение нескольких моделей
4. Реализовать обработку столбца `name` для улучшения качества

---

## Запуск приложения

```bash
cd HW1
streamlit run app.py
```

---

## Структура репозитория

```
HW1/
├── HW1_Regression_with_inference_base.ipynb  # Ноутбук с экспериментами
├── model_artifacts.pickle                     # Модель и артефакты для инференса
├── eda_data.pickle                           # Данные для EDA визуализаций
├── app.py                                    # Streamlit приложение
├── requirements.txt                          # Зависимости
├── CONCLUSIONS.md                            # Этот файл
└── ydata_profile_report.html                 # Отчёт ydata-profiling
```
